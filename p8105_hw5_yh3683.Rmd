---
title: "p8105_hw5_yh3683"
author: "Yining He"
date: "2024-11-11"
output: github_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(ggplot2)
library(dplyr)
library(rvest)
library(broom)
```

# Problem 1

Check if at least two people share a birthday
```{r}
birthday_simulation <- function(n) {
  birthdays <- sample(1:365, n, replace = TRUE) 
  return(any(duplicated(birthdays))) 
}
```


Run 10,000 simulations for group sizes 2-50, calculate shared birthday probability for each size, and plot the probabilities against group sizes.
```{r echo=FALSE}
n_simulations <- 10000
group_sizes <- 2:50

# Simulations for each group size
results <- map_dbl(group_sizes, function(n) {
  mean(replicate(n_simulations, birthday_simulation(n)))  # Average TRUE/FALSE values
})

# Plotting 
results_df <- tibble(
  group_size = group_sizes,
  probability = results
)
results_df %>%
  ggplot(aes(x = group_size, y = probability)) +
  geom_line() +
  geom_point() +
  labs(
    title = "Probability of Shared Birthdays in a Group",
    x = "Group Size",
    y = "Probability of At Least One Shared Birthday"
  ) +
  theme_minimal()
```
The plot shows that the probability of at least two people sharing a birthday increases rapidly with group size, surpassing 50% at around 23 people, demonstrating the Birthday Paradox.